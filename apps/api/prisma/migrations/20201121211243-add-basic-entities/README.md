# Migration `20201121211243-add-basic-entities`

This migration has been generated by Matthias Alif at 11/21/2020, 10:12:43 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "Driver" (
    "id" TEXT NOT NULL,
    "code" TEXT,
    "givenName" TEXT NOT NULL,
    "familyName" TEXT NOT NULL,
    "permanentNumber" INTEGER,
    "dateOfBirth" TIMESTAMP(3) NOT NULL,
    "url" TEXT NOT NULL,
    "nationality" TEXT NOT NULL,
    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "updatedAt" TIMESTAMP(3) NOT NULL,

    PRIMARY KEY ("id")
)

CREATE TABLE "Constructor" (
    "id" TEXT NOT NULL,
    "season" INTEGER NOT NULL,
    "name" TEXT NOT NULL,
    "nationality" TEXT NOT NULL,
    "url" TEXT NOT NULL,
    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "updatedAt" TIMESTAMP(3) NOT NULL,

    PRIMARY KEY ("id")
)

CREATE TABLE "DriverStanding" (
    "position" INTEGER NOT NULL,
    "points" INTEGER NOT NULL,
    "wins" INTEGER NOT NULL,
    "driverId" TEXT NOT NULL,
    "seasonYear" INTEGER NOT NULL,
    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "updatedAt" TIMESTAMP(3) NOT NULL,

    PRIMARY KEY ("position")
)

CREATE TABLE "ConstructorStanding" (
    "position" INTEGER NOT NULL,
    "points" INTEGER NOT NULL,
    "wins" INTEGER NOT NULL,
    "seasonYear" INTEGER NOT NULL,
    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "updatedAt" TIMESTAMP(3) NOT NULL,

    PRIMARY KEY ("position")
)

CREATE TABLE "Season" (
    "year" INTEGER NOT NULL,
    "driverId" TEXT,
    "constructorId" TEXT,

    PRIMARY KEY ("year")
)

ALTER TABLE "DriverStanding" ADD FOREIGN KEY("seasonYear")REFERENCES "Season"("year") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "ConstructorStanding" ADD FOREIGN KEY("seasonYear")REFERENCES "Season"("year") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "Season" ADD FOREIGN KEY("driverId")REFERENCES "Driver"("id") ON DELETE SET NULL ON UPDATE CASCADE

ALTER TABLE "Season" ADD FOREIGN KEY("constructorId")REFERENCES "Constructor"("id") ON DELETE SET NULL ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20201121211243-add-basic-entities
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,74 @@
+// This is your Prisma schema file,
+// learn more about it in the docs: https://pris.ly/d/prisma-schema
+
+datasource db {
+  provider = "postgresql"
+  url = "***"
+}
+
+generator client {
+  provider = "prisma-client-js"
+}
+
+model Driver {
+  id              String   @id
+  code            String?
+  givenName       String
+  familyName      String
+  permanentNumber Int?
+  dateOfBirth     DateTime
+  url             String
+  nationality     String
+  seasons         Season[]
+
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+}
+
+model Constructor {
+  id          String   @id
+  season      Int
+  name        String
+  nationality String
+  url         String
+  seasons     Season[]
+
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+}
+
+model DriverStanding {
+  position Int    @id
+  points   Int
+  wins     Int
+  driverId String
+
+  seasonYear Int
+  season     Season @relation(fields: [seasonYear], references: [year])
+
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+
+}
+
+model ConstructorStanding {
+  position Int @id
+  points   Int
+  wins     Int
+
+  season     Season @relation(fields: [seasonYear], references: [year])
+  seasonYear Int
+
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+}
+
+model Season {
+  year                Int                   @id
+  Driver              Driver?               @relation(fields: [driverId], references: [id])
+  driverId            String?
+  Constructor         Constructor?          @relation(fields: [constructorId], references: [id])
+  constructorId       String?
+  DriverStanding      DriverStanding[]
+  ConstructorStanding ConstructorStanding[]
+}
```
